
<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="referrer" content="origin" />
    <meta property="og:description" content="In this problem, a rooted tree is a&amp;#160;directed&amp;#160;graph such that, there is exactly one node (t" />
    <meta http-equiv="Cache-Control" content="no-transform" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>[LeetCode] 685. Redundant Connection II 冗余的连接之二 - Grandyang - 博客园</title>
    
    <link rel="stylesheet" href="/css/blog-common.min.css?v=PyyhYDRKBG1sYtpoHme_xHO5AMd5iN57I45iBKF8FVY" />
    <link id="MainCss" rel="stylesheet" href="/skins/unlimitedsunlight/bundle-unlimitedsunlight.min.css?v=0PW-IbyD73rSsrHXyZPdWAdlgI9zvcQ6P3MLE4OIhi4" />
    
    <link id="mobile-style" media="only screen and (max-width: 767px)" type="text/css" rel="stylesheet" href="/skins/unlimitedsunlight/bundle-unlimitedsunlight-mobile.min.css?v=1PFKcj_AbkIURdVbGrJ7RA7MSm_08tLLOsnXtqTHyME" />
    
    <link type="application/rss+xml" rel="alternate" href="https://www.cnblogs.com/grandyang/rss" />
    <link type="application/rsd+xml" rel="EditURI" href="https://www.cnblogs.com/grandyang/rsd.xml" />
    <link type="application/wlwmanifest+xml" rel="wlwmanifest" href="https://www.cnblogs.com/grandyang/wlwmanifest.xml" />
    <script src="https://common.cnblogs.com/scripts/jquery-2.2.0.min.js"></script>
    <script src="/js/blog-common.min.js?v=F-Iy-_Lj7VcUKRIvNkS6UZ5LItMqjh1_L0VZk9Yxfb8"></script>
    <script>
        var currentBlogId = 198221;
        var currentBlogApp = 'grandyang';
        var cb_enable_mathjax = true;
        var isLogined = false;
    </script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
        tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']], processClass: 'math', processEscapes: true },
        TeX: {
        equationNumbers: { autoNumber: ['AMS'], useLabelIds: true },
        extensions: ['extpfeil.js', 'mediawiki-texvc.js'],
        Macros: {bm: "\\boldsymbol"}
        },
        'HTML-CSS': { linebreaks: { automatic: true } },
        SVG: { linebreaks: { automatic: true } }
        });
    </script>
    <script src="https://mathjax.cnblogs.com/2_7_5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
</head>
<body>
    <a name="top"></a>
    <div id="page_begin_html">
        <a href="https://github.com/grandyang"> 
<img style="position: absolute; top: 0; left: 0; border: 0; z-index:9999;" 
src="https://github.blog/wp-content/uploads/2008/12/forkme_left_gray_6d6d6d.png" 
alt="Fork me on GitHub"> 
</a>

<script src="https://files.cnblogs.com/files/grandyang/tctip-1.0.4.js" defer></script>
<script>
new tctip({
top: '20%',
button: {
  id:7,
  type: 'zanzhu',
},
list: [
  {
        type: 'wechat',
	qrImg: 'https://files.cnblogs.com/files/grandyang/wepay.gif'
  }, {
	type: 'announcement',
        qrText: '2020，新的征途...'
  }
]
}).init()
</script>
    </div>
    
<!--done-->
<div id="home">
<div id="header">
	<div id="blogTitle">
        <a id="lnkBlogLogo" href="https://www.cnblogs.com/grandyang/"><img id="blogLogo" src="/skins/custom/images/logo.gif" alt="返回主页" /></a>		
		
<!--done-->
<h1><a id="Header1_HeaderTitle" class="headermaintitle HeaderMainTitle" href="https://www.cnblogs.com/grandyang/">Grandyang</a>
</h1>
<h2>
仰天长啸仗剑红尘，冬去春来寒暑几更...
</h2>




		
	</div><!--end: blogTitle 博客的标题和副标题 -->
	<div id="navigator">
		
<ul id="navList">
<li><a id="blog_nav_sitehome" class="menu" href="https://www.cnblogs.com/">
博客园</a>
</li>
<li>
<a id="blog_nav_myhome" class="menu" href="https://www.cnblogs.com/grandyang/">
首页</a>
</li>
<li>

<a id="blog_nav_newpost" class="menu" href="https://i.cnblogs.com/EditPosts.aspx?opt=1">
新随笔</a>
</li>
<li>
<a id="blog_nav_contact" class="menu" href="https://msg.cnblogs.com/send/Grandyang">
联系</a></li>
<li>
<a id="blog_nav_rss" class="menu" href="https://www.cnblogs.com/grandyang/rss/">
订阅</a>
<!--<partial name="./Shared/_XmlLink.cshtml" model="Model" /></li>--></li>
<li>
<a id="blog_nav_admin" class="menu" href="https://i.cnblogs.com/">
管理</a>
</li>
</ul>


		<div class="blogStats">
			
			<span id="stats_post_count">随笔 - 
1424&nbsp; </span>
<span id="stats_article_count">文章 - 
1&nbsp; </span>
<span id="stats-comment_count">评论 - 
4014</span>

			
		</div><!--end: blogStats -->
	</div><!--end: navigator 博客导航栏 -->
</div><!--end: header 头部 -->

<div id="main">
	<div id="mainContent">
	<div class="forFlow">
		<div id="post_detail">
    <!--done-->
    <div id="topics">
        <div class="post">
            <h1 class = "postTitle">
                
<a id="cb_post_title_url" class="postTitle2" href="https://www.cnblogs.com/grandyang/p/8445733.html">[LeetCode] 685. Redundant Connection II 冗余的连接之二</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                
<div id="cnblogs_post_body" class="blogpost-body ">
    <p>&nbsp;</p>
<div class="question-description">
<p>In this problem, a rooted tree is a&nbsp;directed&nbsp;graph such that, there is exactly one node (the root) for which all other nodes are descendants of this node, plus every node has exactly one parent, except for the root node which has no parents.</p>
<p>The given input is a directed graph that started as a rooted tree with N nodes (with distinct values 1, 2, ..., N), with one additional directed edge added. The added edge has two different vertices chosen from 1 to N, and was not an edge that already existed.</p>
<p>The resulting graph is given as a 2D-array of&nbsp;<code>edges</code>. Each element of&nbsp;<code>edges</code>&nbsp;is a pair&nbsp;<code>[u, v]</code>&nbsp;that represents a&nbsp;directed&nbsp;edge connecting nodes&nbsp;<code>u</code>&nbsp;and&nbsp;<code>v</code>, where&nbsp;<code>u</code>&nbsp;is a parent of child&nbsp;<code>v</code>.</p>
<p>Return an edge that can be removed so that the resulting graph is a rooted tree of N nodes. If there are multiple answers, return the answer that occurs last in the given 2D-array.</p>
<p>Example 1:</p>
<pre>Input: [[1,2], [1,3], [2,3]]
Output: [2,3]
Explanation: The given directed graph will be like this:
  1
 / \
v   v
2--&gt;3
</pre>
<p>&nbsp;</p>
<p>Example 2:</p>
<pre>Input: [[1,2], [2,3], [3,4], [4,1], [1,5]]
Output: [4,1]
Explanation: The given directed graph will be like this:
5 &lt;- 1 -&gt; 2
     ^    |
     |    v
     4 &lt;- 3
</pre>
<p>&nbsp;</p>
<p>Note:</p>
<ul>
<li>The size of the input 2D-array will be between 3 and 1000.</li>
<li>Every integer represented in the 2D-array will be between 1 and N, where N is the size of the input array.</li>
</ul>
<p>&nbsp;</p>
</div>
<p>这道题是之前那道&nbsp;<a href="http://www.cnblogs.com/grandyang/p/7628977.html">Redundant Connection</a>&nbsp;的拓展，那道题给的是无向图，只需要删掉组成环的最后一条边即可，归根到底就是检测环就行了。而这道题给的是有向图，整个就复杂多了，因为有多种情况存在，比如给的例子1就是无环，但是有入度为2的结点3。再比如例子2就是有环，但是没有入度为2的结点。其实还有一种情况例子没有给出，就是既有环，又有入度为2的结点。好，现在就来总结一下这三种情况：</p>
<p>第一种：无环，但是有结点入度为2的结点（结点3）</p>
<p>[[1,2], [1,3], [2,3]]</p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre>  <span style="color: #800080;">1</span>
 /<span style="color: #000000;"> \
v   v
</span><span style="color: #800080;">2</span>--&gt;<span style="color: #800080;">3</span></pre>
</div>
<p>&nbsp;</p>
<p>第二种：有环，没有入度为2的结点</p>
<p>[[1,2], [2,3], [3,4], [4,1], [1,5]]</p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><span style="color: #800080;">5</span> &lt;- <span style="color: #800080;">1</span> -&gt; <span style="color: #800080;">2</span>
     ^    |
     |<span style="color: #000000;">    v
     </span><span style="color: #800080;">4</span> &lt;- <span style="color: #800080;">3</span></pre>
</div>
<p>&nbsp;</p>
<p>第三种：有环，且有入度为2的结点（结点1）</p>
<p>[[1,2],[2,3],[3,1],[1,4]]</p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre>     <span style="color: #800080;">4</span>
    /<span style="color: #000000;">
   v
   </span><span style="color: #800080;">1</span>
 /  ^<span style="color: #000000;">
v    \
</span><span style="color: #800080;">2</span> --&gt;<span style="color: #800080;">3</span></pre>
</div>
<p>&nbsp;</p>
<p>对于这三种情况的处理方法各不相同，首先对于第一种情况，返回的产生入度为2的后加入的那条边 [2, 3]，而对于第二种情况，返回的是刚好组成环的最后加入的那条边 [4, 1]，最后对于第三种情况返回的是组成环，且组成入度为2的那条边 [3, 1]。</p>
<p>明白了这些，先来找入度为2的点，如果有的话，那么将当前产生入度为2的后加入的那条边标记为 second，前一条边标记为 first。然后来找环，为了方便起见，找环使用联合查找 Union Find 的方法，可参见&nbsp;<a href="http://www.cnblogs.com/grandyang/p/7628977.html">Redundant Connection</a>&nbsp;中的解法三。当找到了环之后，如果 first 不存在，说明是第二种情况，返回刚好组成环的最后加入的那条边。如果 first 存在，说明是第三种情况，返回 first。如果没有环存在，说明是第一种情况，返回 second，参见代码如下：</p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">class</span><span style="color: #000000;"> Solution {
</span><span style="color: #0000ff;">public</span><span style="color: #000000;">:
    vector</span>&lt;<span style="color: #0000ff;">int</span>&gt; findRedundantDirectedConnection(vector&lt;vector&lt;<span style="color: #0000ff;">int</span>&gt;&gt;&amp;<span style="color: #000000;"> edges) {
        </span><span style="color: #0000ff;">int</span> n =<span style="color: #000000;"> edges.size();
        vector</span>&lt;<span style="color: #0000ff;">int</span>&gt; root(n + <span style="color: #800080;">1</span>, <span style="color: #800080;">0</span><span style="color: #000000;">), first, second;
        </span><span style="color: #0000ff;">for</span> (auto&amp;<span style="color: #000000;"> edge : edges) {
            </span><span style="color: #0000ff;">if</span> (root[edge[<span style="color: #800080;">1</span>]] == <span style="color: #800080;">0</span><span style="color: #000000;">) {
                root[edge[</span><span style="color: #800080;">1</span>]] = edge[<span style="color: #800080;">0</span><span style="color: #000000;">];
            } </span><span style="color: #0000ff;">else</span><span style="color: #000000;"> {
                first </span>= {root[edge[<span style="color: #800080;">1</span>]], edge[<span style="color: #800080;">1</span><span style="color: #000000;">]};
                second </span>=<span style="color: #000000;"> edge;
                edge[</span><span style="color: #800080;">1</span>] = <span style="color: #800080;">0</span><span style="color: #000000;">;
            }
        }
        </span><span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i = <span style="color: #800080;">0</span>; i &lt;= n; ++i) root[i] =<span style="color: #000000;"> i;
        </span><span style="color: #0000ff;">for</span> (auto&amp;<span style="color: #000000;"> edge : edges) {
            </span><span style="color: #0000ff;">if</span> (edge[<span style="color: #800080;">1</span>] == <span style="color: #800080;">0</span>) <span style="color: #0000ff;">continue</span><span style="color: #000000;">;
            </span><span style="color: #0000ff;">int</span> x = getRoot(root, edge[<span style="color: #800080;">0</span>]), y = getRoot(root, edge[<span style="color: #800080;">1</span><span style="color: #000000;">]);
            </span><span style="color: #0000ff;">if</span> (x == y) <span style="color: #0000ff;">return</span> first.empty() ?<span style="color: #000000;"> edge : first;
            root[x] </span>=<span style="color: #000000;"> y;
        }
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> second;
    }
    </span><span style="color: #0000ff;">int</span> getRoot(vector&lt;<span style="color: #0000ff;">int</span>&gt;&amp; root, <span style="color: #0000ff;">int</span><span style="color: #000000;"> i) {
        </span><span style="color: #0000ff;">return</span> i == root[i] ?<span style="color: #000000;"> i : getRoot(root, root[i]);
    }
};</span></pre>
</div>
<p>&nbsp;</p>
<p>讨论：使用联合查找 Union Find 的方法一般都需要写个子函数，来查找祖宗结点，上面的解法 getRoot() 函数就是这个子函数，使用递归的形式来写的，其实还可以用迭代的方式来写，下面这两种写法都可以：</p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">int</span> getRoot(vector&lt;<span style="color: #0000ff;">int</span>&gt;&amp; root, <span style="color: #0000ff;">int</span><span style="color: #000000;"> i) {
    </span><span style="color: #0000ff;">while</span> (i !=<span style="color: #000000;"> root[i]) {
        root[i] </span>=<span style="color: #000000;"> root[root[i]];
        i </span>=<span style="color: #000000;"> root[i];
    }
    </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> i;
}</span></pre>
</div>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">int</span> getRoot(vector&lt;<span style="color: #0000ff;">int</span>&gt;&amp; root, <span style="color: #0000ff;">int</span><span style="color: #000000;"> i) {
    </span><span style="color: #0000ff;">while</span> (i != root[i]) i =<span style="color: #000000;"> root[i];
    </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> i;
}</span></pre>
</div>
<p>&nbsp;</p>
<p>Github 同步地址：</p>
<p><a href="https://github.com/grandyang/leetcode/issues/685">https://github.com/grandyang/leetcode/issues/685</a></p>
<p>&nbsp;</p>
<p>类似题目：</p>
<p><a href="http://www.cnblogs.com/grandyang/p/7628977.html">Redundant Connection</a></p>
<p><a href="http://www.cnblogs.com/grandyang/p/6686983.html">Friend Circles</a></p>
<p><a href="http://www.cnblogs.com/grandyang/p/7829169.html">Accounts Merge</a></p>
<p><a href="http://www.cnblogs.com/grandyang/p/5190419.html">Number of Islands II</a></p>
<p><a href="http://www.cnblogs.com/grandyang/p/5257919.html">Graph Valid Tree</a></p>
<p><a href="http://www.cnblogs.com/grandyang/p/5166356.html">Number of Connected Components in an Undirected Graph</a></p>
<p><a class="postTitle2" href="https://www.cnblogs.com/grandyang/p/11503433.html">Similar String Groups</a></p>
<p>&nbsp;</p>
<p>参考资料：</p>
<p><a href="https://leetcode.com/problems/redundant-connection-ii/" target="_blank">https://leetcode.com/problems/redundant-connection-ii/</a></p>
<p><a href="https://leetcode.com/problems/redundant-connection-ii/discuss/108045/C++Java-Union-Find-with-explanation-O(n)" target="_blank">https://leetcode.com/problems/redundant-connection-ii/discuss/108045/C++Java-Union-Find-with-explanation-O(n)</a></p>
<p><a href="https://leetcode.com/problems/redundant-connection-ii/discuss/108058/one-pass-disjoint-set-solution-with-explain" target="_blank">https://leetcode.com/problems/redundant-connection-ii/discuss/108058/one-pass-disjoint-set-solution-with-explain</a></p>
<p>&nbsp;</p>
<p><a id="cb_post_title_url" class="postTitle2" href="http://www.cnblogs.com/grandyang/p/4606334.html">LeetCode All in One 题目讲解汇总(持续更新中...)</a></p>
</div>
<div id="MySignature"></div>
<div class="clear"></div>
<div id="blog_post_info_block">
    <div id="blog_post_info"></div>
    <div class="clear"></div>
    <div id="post_next_prev"></div>
</div>
            </div>
            <div class="postDesc">posted @ 
<span id="post-date">2018-02-12 22:29</span>&nbsp;
<a href="https://www.cnblogs.com/grandyang/">Grandyang</a>&nbsp;
阅读(<span id="post_view_count">...</span>)&nbsp;
评论(<span id="post_comment_count">...</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=8445733" rel="nofollow">编辑</a>&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(8445733);return false;">收藏</a></div>
        </div>
	    
	    
    </div><!--end: topics 文章、评论容器-->
</div>
<script src="https://common.cnblogs.com/highlight/9.12.0/highlight.min.js"></script>
<script>markdown_highlight();</script>
<script>
    var allowComments = true, cb_blogId = 198221, cb_blogApp = 'grandyang', cb_blogUserGuid = '02affae8-0e77-e111-aa3f-842b2b196315';
    var cb_entryId = 8445733, cb_entryCreatedDate = '2018-02-12 22:29', cb_postType = 1; 
    loadViewCount(cb_entryId);
</script><a name="!comments"></a>
<div id="blog-comments-placeholder"></div>
<script>
    var commentManager = new blogCommentManager();
    commentManager.renderComments(0);
</script>

<div id="comment_form" class="commentform">
    <a name="commentform"></a>
    <div id="divCommentShow"></div>
    <div id="comment_nav"><span id="span_refresh_tips"></span><a href="javascript:void(0);" onclick="return RefreshCommentList();" id="lnk_RefreshComments" runat="server" clientidmode="Static">刷新评论</a><a href="#" onclick="return RefreshPage();">刷新页面</a><a href="#top">返回顶部</a></div>
    <div id="comment_form_container"></div>
    <div class="ad_text_commentbox" id="ad_text_under_commentbox"></div>
    <div id="ad_t2"></div>
    <div id="opt_under_post"></div>
    <script async="async" src="https://www.googletagservices.com/tag/js/gpt.js"></script>
    <script>
        var googletag = googletag || {};
        googletag.cmd = googletag.cmd || [];
    </script>
    <script>
        googletag.cmd.push(function () {
            googletag.defineSlot("/1090369/C1", [300, 250], "div-gpt-ad-1546353474406-0").addService(googletag.pubads());
            googletag.defineSlot("/1090369/C2", [468, 60], "div-gpt-ad-1539008685004-0").addService(googletag.pubads());
            googletag.pubads().enableSingleRequest();
            googletag.enableServices();
        });
    </script>
    <div id="cnblogs_c1" class="c_ad_block">
        <div id="div-gpt-ad-1546353474406-0" style="height:250px; width:300px;"></div>
    </div>
    <div id="under_post_news"></div>
    <div id="cnblogs_c2" class="c_ad_block">
        <div id="div-gpt-ad-1539008685004-0" style="height:60px; width:468px;">
            <script>
                if (new Date() >= new Date(2018, 9, 13)) {
                    googletag.cmd.push(function () { googletag.display("div-gpt-ad-1539008685004-0"); });
                }
            </script>
        </div>
    </div>
    <div id="under_post_kb"></div>
    <div id="HistoryToday" class="c_ad_block"></div>
    <script type="text/javascript">
        fixPostBody();
        setTimeout(function () { incrementViewCount(cb_entryId); }, 50);
        deliverAdT2();
        deliverAdC1();
        deliverAdC2();
        loadNewsAndKb();
        loadBlogSignature();
LoadPostCategoriesTags(cb_blogId, cb_entryId);        LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);
        GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate, cb_postType);
        loadOptUnderPost();
        GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);
    </script>
</div>
	</div><!--end: forFlow -->
	</div><!--end: mainContent 主体内容容器-->

	<div id="sideBar">
		<div id="sideBarMain">
			
<div id="sidebar_news" class="newsItem">
            <script>loadBlogNews();</script>
</div>

			<div id="blog-calendar" style="display:none"></div><script>loadBlogDefaultCalendar();</script>
			
			<div id="leftcontentcontainer">
				<div id="blog-sidecolumn"></div>
                    <script>loadBlogSideColumn();</script>
			</div>
			
		</div><!--end: sideBarMain -->
	</div><!--end: sideBar 侧边栏容器 -->
	<div class="clear"></div>
	</div><!--end: main -->
	<div class="clear"></div>
	<div id="footer">
		<!--done-->
Copyright &copy; 2020 Grandyang
<br /><span id="poweredby">Powered by .NET Core 3.1.0 on Linux</span>



	</div><!--end: footer -->
</div><!--end: home 自定义的最大容器 -->


    <div id="page_end_html">
        <a href="https://github.com/grandyang"> 
<img style="position: absolute; top: 0; left: 0; border: 0; z-index:9999;" 
src="https://github.blog/wp-content/uploads/2008/12/forkme_left_gray_6d6d6d.png" 
alt="Fork me on GitHub"> 
</a>

<script src="https://files.cnblogs.com/files/grandyang/tctip-1.0.4.js" defer></script>
<script>
new tctip({
top: '20%',
button: {
  id:7,
  type: 'zanzhu',
},
list: [
  {
        type: 'wechat',
	qrImg: 'https://files.cnblogs.com/files/grandyang/wepay.gif'
  }, {
	type: 'announcement',
        qrText: '2020，新的征途...'
  }
]
}).init()
</script>
    </div>
</body>
</html>